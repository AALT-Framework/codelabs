
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Como testar a acessibilidade em soluções mobile (WebMedia 2023)</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" ga4id=""></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  codelab-ga4id=""
                  id="tutorial-acessibilidade-webmedia2023"
                  title="Como testar a acessibilidade em soluções mobile (WebMedia 2023)"
                  environment="web"
                  feedback-link="">
    
      <google-codelab-step label="Introdução" duration="1">
        <p>Os aplicativos <em>mobile</em> podem ajudar as pessoas a realizar tarefas diárias. No entanto, pessoas com deficiência podem enfrentar várias barreiras ao usar os recursos desses dispositivos se eles não fornecerem acessibilidade adequada. Desenvolvedores de software desempenham um papel crucial na promoção de melhorias de acessibilidade digital, e os testes automatizados podem ajudá-los.</p>
<p>Este tutorial visa abordar esses desafios e capacitar profissionais de desenvolvimento, design e teste para enfrentar as complexidades da acessibilidade em soluções mobile. Com foco em aplicativos Android nativos, exploraremos abordagens e ferramentas para testar e melhorar a acessibilidade. Ao final do tutorial, você será capaz de criar aplicativos com acessibilidade.</p>
<p>Serão apresentadas três alternativas de ferramentas disponíveis para auxiliar a realização de testes de acessibilidade em aplicativos Android nativos. Você será guiado a identificar problemas de acessibilidade em um aplicativo de exemplo – um <em>app</em> Contador – com cada uma das ferramentas apresentadas.</p>
<p>Serão utilizadas as seguintes ferramentas:</p>
<ul>
<li><strong>Scanner de Acessibilidade (</strong><strong><em>Accessibility Scanner</em></strong><strong>)</strong>: ferramenta do Google para verificar aplicativos móveis em busca de problemas de acessibilidade.</li>
<li><strong>Espresso</strong>: ferramenta de automação de testes de interface do usuário no Android, para testes instrumentados.</li>
<li><strong>AATK (Kit de Testes de Acessibilidade Automatizados)</strong>: uma biblioteca Android contendo testes de acessibilidade automatizados locais, ou seja, que não requerem uso de disposivito físico ou emulado.</li>
</ul>
<p>Para cada ferramenta, serão fornecidas as instruções passo-a-passo para preparação, configuração, escrita dos testes (quando aplicável), execução e visualização dos resultados. Ao final também haverá um passo-a-passo para solucionar os problemas encontrados e re-executar os testes.</p>
<h2 is-upgraded>Recursos Necessários</h2>
<ul>
<li>Estação de trabalho com Android Studio instalado (versão 2021.1.1 ou superior)</li>
<li>Dispositivo:<ul>
<li>smartphone Android com cabo USB e modo de desenvolvedor habilitado; ou</li>
<li>emulador com Play Store baixado e configurado no Android Studio (sugestão: Pixel 2 API 30).</li>
</ul>
<aside class="special"><p><strong>ATENÇÃO!!!</strong> Se você for utilizar seu próprio smartphone e não souber como habilitar o modo de desenvolvedor, siga as instruções <a href="https://developer.android.com/studio/debug/dev-options" target="_blank">deste tutorial</a>. Caso opte por utilizar o emulador, siga as instruções <a href="https://developer.android.com/studio/run/emulator" target="_blank">deste tutorial</a>. Chame o instrutor se precisar de ajuda. </p>
</aside>
</li>
</ul>
<h2 is-upgraded>Pré-requisitos</h2>
<p>Não é necessário nenhum conhecimento prévio sobre acessibilidade ou testes automatizados para realizar este codelab. No entanto, assumimos que você:</p>
<ol type="1">
<li>Possui o Android Studio instalado em seu ambiente de desenvolvimento.</li>
<li>Seja capaz de baixar o projeto do GitHub e abrir no Android Studio.</li>
</ol>
<h2 is-upgraded>O que você aprenderá</h2>
<p>Ao realizar este codelab, você será capaz de:</p>
<ul>
<li>Compreender os conceitos básicos de acessibilidade em sistemas computacionais.</li>
<li>Aprender a utilizar ferramentas para testar a acessibilidade em aplicativos Android nativos.</li>
<li>Identificar, solucionar e prevenir problemas de acessibilidade em um aplicativo de exemplo por meio de testes de acessibilidade automatizados.</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="O app Contador" duration="0">
        <p>Neste codelab, você trabalhará com um aplicativo existente, o <strong>Contador</strong>, derivado do <a href="https://developer.android.com/codelabs/starting-android-accessibility" target="_blank">Google Codelabs</a>. Este aplicativo permite aos usuários rastrear, incrementar e decrementar uma contagem numérica. Embora o aplicativo seja simples, você descobrirá que ele tem alguns problemas de acessibilidade que podem dificultar que usuários com deficiência interajam com ele.</p>
<p>Você pode obter o código-fonte da versão inicial do aplicativo <a href="https://github.com/AALT-Framework/poor-accessibility-apps" target="_blank">neste link</a>.</p>
<h2 is-upgraded>Clonando o projeto</h2>
<p>Você será orientado a executar testes de acessibilidade para identificar esses problemas com cada uma das três ferramentas apresentadas neste tutorial. Para isso, você pode, de acordo com suas habilidades e preferências, escolher entre as seguintes opções:</p>
<h3 is-upgraded><strong>Opção A) Clonar o projeto do aplicativo Contador do GitHub três vezes, em diferentes pastas para cada ferramenta.</strong></h3>
<ol type="1">
<li>Abra o terminal ou prompt de comando no diretório onde deseja clonar o projeto.</li>
<li>Clone o repositório disponível em <code>https://github.com/AALT-Framework/poor-accessibility-apps/</code></li>
<li>Crie uma cópia da pasta &#34;Contador&#34;, que está dentro do repositório clonado, para cada projeto. Nomeie cada cópia de acordo com a ferramenta que você deseja testar, da seguinte forma: <ul>
<li><strong>Contador-AccessibilityScanner</strong></li>
<li><strong>Contador-Espresso</strong></li>
<li><strong>Contador-AATK</strong></li>
</ul>
</li>
<li>Para cada ferramenta, abra a respectiva pasta do projeto no Android Studio e siga as instruções do tutorial.</li>
</ol>
<p><strong>Exemplo em Linux</strong></p>
<pre><code language="language-bash" class="language-bash">git clone https://github.com/AALT-Framework/poor-accessibility-apps/
cp -r poor-accessibility-apps/Contador Contador-AccessibilityScanner
cp -r poor-accessibility-apps/Contador Contador-Espresso
cp -r poor-accessibility-apps/Contador Contador-AATK
</code></pre>
<h3 is-upgraded><strong>Opção B) Clonar o projeto do aplicativo Contador do GitHub uma vez e criar três </strong><strong><em>branches</em></strong><strong> diferentes, uma para cada ferramenta.</strong></h3>
<ol type="1">
<li>Abra o terminal ou prompt de comando no diretório onde deseja clonar o projeto.</li>
<li>Clone o repositório disponível em <code>https://github.com/AALT-Framework/poor-accessibility-apps/</code><pre><code language="language-bash" class="language-bash">git clone https://github.com/AALT-Framework/poor-accessibility-apps/
</code></pre>
</li>
<li>Isso irá clonar o repositório inteiro. Entre na pasta &#34;poor-accessibility-apps&#34; e crie uma nova branch para cada ferramenta. Nomeie cada branch de acordo com a ferramenta que você deseja testar, da seguinte forma:<ul>
<li>AccessibilityScanner</li>
<li>Espresso</li>
<li>AATK</li>
</ul>
<pre><code language="language-bash" class="language-bash">cd poor-accessibility-apps
git checkout -b AccessibilityScanner
git checkout -b Espresso
git checkout -b AATK
</code></pre>
</li>
<li>Para cada ferramenta, alterne para a respectiva branch da ferramenta. <strong>Exemplo para o Accessibility Scanner</strong><pre><code language="language-bash" class="language-bash">git checkout AccessibilityScanner
</code></pre>
</li>
<li>Abra o projeto da subpasta &#34;Contador&#34; no Android Studio e siga as instruções do tutorial.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Accessibility Scanner" duration="20">
        <p>O <strong>Scanner de acessibilidade (Accessibility Scanner)</strong> é uma ferramenta criada pelo Google para sugerir melhorias de acessibilidade em <em>apps</em> Android, como aumento de áreas de toque pequenas, aumento de contraste e descrições de conteúdo. Elas possibilitam que pessoas com deficiência possam usar os <em>apps</em> com mais facilidade.</p>
<h2 is-upgraded>Preparação</h2>
<ol type="1">
<li>No Android Studio, abra o projeto do aplicativo <strong>Contador</strong>, da pasta especificada para o <strong>Accessibility Scanner</strong> no 2º passo deste treinamento.</li>
<li>Execute o projeto no dispositivo Android ou emulador. O app Contador será aberto.</li>
<li>Siga estas etapas para fazer o download e configurar o Scanner de acessibilidade:<ol type="1">
<li>Abra o app Play Store no dispositivo Android.</li>
<li><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.accessibility.auditor&hl=pt-br" target="_blank">Faça o download do Scanner de acessibilidade na Google Play Store</a>.</li>
<li>Após instalar o <strong>Scanner de acessibilidade</strong>, navegue até <strong>Configurações</strong> &gt; <strong>Acessibilidade no dispositivo</strong>. Localize e ative o Scanner de acessibilidade (toque em <strong>&#34;Permitir&#34;</strong>&#34; ou <strong>&#34;OK&#34;</strong> e, em seguida, em <strong>&#34;Iniciar autorização&#34;</strong> para concluir o fluxo de configuração).</li>
<li>Retorne ao app Contador. Sua tela estará assim:</li>
</ol>
<img alt="Tela do app Contador" src="img/bdd8e1ce7558eb81.png"></li>
</ol>
<p>O <strong>Scanner de acessibilidade</strong> cria um botão de ação flutuante (FAB, na sigla em inglês) azul que fica sobreposto ao conteúdo na tela.</p>
<p class="image-container"><img alt="Botão de ação flutuante (FAB)" src="img/fb39571ce90d713.png"></p>
<p>Você pode tocar no FAB para iniciar uma verificação de acessibilidade. Faremos isso daqui a pouco. Para mover o FAB para outra área da tela, mantenha-o pressionado e arraste.</p>
<h2 is-upgraded>Como analisar o app Contador</h2>
<p>Nesta seção, você vai fazer uma auditoria de acessibilidade da tela usando o <strong>Scanner de acessibilidade</strong>:</p>
<ol type="1">
<li>Toque no FAB para iniciar a verificação. Ao fazer isso, o Scanner de acessibilidade examina a IU da tela, realiza uma auditoria rápida de acessibilidade e prepara as sugestões de melhoria.</li>
<li>Toque em &#34;<strong>Verificar</strong>&#34; para ver as sugestões de melhoria. O Scanner de acessibilidade exibe uma lista de sugestões de melhoria de acessibilidade, classificadas por prioridade. As sugestões de melhoria são baseadas nas diretrizes de acessibilidade do Google.</li>
<li>Toque em uma sugestão de melhoria para ver mais detalhes. Por exemplo, toque em &#34;<strong>Aumentar o contraste</strong>&#34; para ver mais detalhes sobre essa sugestão.</li>
</ol>
<h2 is-upgraded>Entenda as sugestões do Scanner de Acessibilidade</h2>
<p>O Scanner de acessibilidade tem cinco sugestões para melhorar a acessibilidade do Contador.</p>
<h3 is-upgraded>Contraste insuficiente</h3>
<p>O Scanner de acessibilidade recomenda corrigir o contraste de cores na visualização que mostra a contagem atual.</p>
<ol type="1">
<li>Toque no campo de contagem, destacado em laranja no meio da tela, para ver a sugestão do Scanner.</li>
<li>Amplie a mensagem de erro e veja detalhes sobre como aplicar a sugestão do Scanner. O Scanner mostra as cores do primeiro e segundo planos, além das proporções de contraste sugeridas.</li>
</ol>
<aside class="special"><p><strong>Por que o contraste de cores é importante para a acessibilidade?</strong> Usuários com baixa visão têm mais dificuldade para ler informações em uma tela quando não há contraste suficiente entre as cores do primeiro e segundo planos. <strong>Proporções baixas de contraste podem deixar a tela embaçada para alguns usuários</strong>, enquanto proporções mais altas deixam a tela mais nítida. Situações diferentes de luz podem aumentar as dificuldades criadas por proporções baixas de contraste. </p>
<p>Esse tipo de recurso ajuda todos os usuários, e não apenas aqueles com deficiência.</p>
</aside>
<h3 is-upgraded>Falta de rótulos</h3>
<p>O Scanner sinaliza os rótulos ausentes em <code>ImageButtons</code> <code>-</code> e <code>+</code> , o que impossibilita que usuários de leitores de tela entendam o propósito desses controles.</p>
<ol type="1">
<li>Toque nos erros associados aos botões <code>-</code> e <code>+</code> e leia as sugestões relacionadas aos rótulos ausentes.</li>
</ol>
<aside class="special"><p><strong>Por que a falta de rótulos é um problema para a acessibilidade?</strong> Usuários cegos ou com baixa visão usam leitores de tela, como o TalkBack, para interagir com os dispositivos. O [TalkBack](https://support.google.com/accessibility/android/answer/6007100?hl=pt-BR) anuncia o conteúdo da tela para os usuários, que podem interagir com ele. Quando um elemento não tem um texto associado (um `ImageButton`, por exemplo), o TalkBack não sabe como informar o propósito dele ao usuário. Em casos assim, o recurso pode anunciar títulos genéricos, como &#34;Botão sem rótulo&#34;, o que não é útil para o usuário. Quando você fornece um rótulo descritivo adequado, o TalkBack pode anunciá-lo ao usuário. </p>
</aside>
<h3 is-upgraded>Áreas de toque insuficientes</h3>
<p>Além dos rótulos ausentes, o <strong>Scanner</strong> sugere aumentar a área de toque dos botões <code>-</code> e <code>+</code>.</p>
<aside class="special"><p><strong>Por que áreas de toque pequenas são um problema para a acessibilidade?</strong> Muitas pessoas têm dificuldade para focar em áreas de toque pequenas na tela. Isso pode acontecer por terem dedos grandes ou alguma condição médica que afeta as habilidades motoras delas. As áreas de toque pequenas também dificultam para os usuários de leitor de tela navegarem em apps movendo um dedo na tela, como durante o uso do recurso [Explorar por toque](https://support.google.com/accessibility/android/answer/6006598?hl=pt-BR) no TalkBack. </p>
<p>Em algumas circunstâncias, áreas de toque inadequadas tornam apps menos acessíveis para todos os usuários, e não apenas aqueles com deficiência.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Como garantir um contraste de cor adequado" duration="0">
        <p>No <strong>Contador</strong>, o contraste de cor é simples de melhorar. A <code>TextView</code> que mostra a contagem usa um plano de fundo cinza-claro com texto cinza:</p>
<pre><code language="language-xml" class="language-xml">&lt;TextView
   ...
   android:background=&#34;@color/lightGrey&#34;
   android:textColor=&#34;@color/grey&#34;
   ...
 /&gt;
</code></pre>
<p>Você pode remover o plano de fundo, escolher outro mais claro ou deixar o texto mais escuro. Neste codelab, vamos escolher uma cor mais escura para o texto. Veja algumas cores que foram definidas em <code>colors.xml</code>:</p>
<pre><code language="language-xml" class="language-xml">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;resources&gt;
   ...
   &lt;color name=&#34;lightGrey&#34;&gt;#EEEEEE&lt;/color&gt;
   &lt;color name=&#34;grey&#34;&gt;#999999&lt;/color&gt;
   &lt;color name=&#34;darkGrey&#34;&gt;#666666&lt;/color&gt;
&lt;/resources&gt;
</code></pre>
<p>Abra <code>res/layout/activity_main.xml</code> e mude <code>android:textColor="@color/grey"</code> para <code>android:textColor="@color/darkGrey"</code>:</p>
<pre><code language="language-xml" class="language-xml">&lt;TextView
   ...
   android:background=&#34;@color/lightGrey&#34;
   android:textColor=&#34;@color/darkGrey&#34;
   ...
 /&gt;
</code></pre>
<p>Agora, execute o app e veja o contraste melhorado:</p>
<table>
<tr><td colspan="1" rowspan="1"><p>Antes</p>
</td><td colspan="1" rowspan="1"><p>Depois</p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p class="image-container"><img alt="Tela do app Contador sem contraste melhorado" src="img/e48af782c716ea54.png"></p>
</td><td colspan="1" rowspan="1"><p class="image-container"><img alt="Tela do app Contador com contraste melhorado" src="img/d0d90bf68ab4f5a6.png"></p>
</td></tr>
</table>
<p>A proporção de contraste agora é de 4.94:1, consideravelmente melhor que 2.45:1, que é o que tínhamos antes:</p>
<table>
<tr><td colspan="1" rowspan="1"></td><td colspan="1" rowspan="1"><p><strong>Contexto</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Cor do texto</strong></p>
</td><td colspan="1" rowspan="1"><p><strong>Taxa de contraste</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Antes</p>
</td><td colspan="1" rowspan="1"><p>#EEEEEE</p>
</td><td colspan="1" rowspan="1"><p>Cinza-claro (#999999)</p>
</td><td colspan="1" rowspan="1"><p><strong>2.45:1</strong></p>
</td></tr>
<tr><td colspan="1" rowspan="1"><p>Depois</p>
</td><td colspan="1" rowspan="1"><p>#EEEEEE</p>
</td><td colspan="1" rowspan="1"><p>Cinza-escuro (#666666)</p>
</td><td colspan="1" rowspan="1"><p><strong>4.94:1</strong></p>
</td></tr>
</table>
<aside class="special"><p><strong>Afinal, o que é um contraste adequado?</strong> As <a href="https://www.w3.org/WAI/standards-guidelines/wcag/" target="_blank">diretrizes de acessibilidade de conteúdo da Web</a> recomendam uma <a href="http://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html" target="_blank">proporção de contraste mínima</a> de 4.5:1 para todo o texto. A proporção de 3.0:1 é considerada aceitável para textos grandes ou em negrito. Tente usar essas taxas, ou maiores, nos seus aplicativos. </p>
</aside>
<p>Pressione o FAB para iniciar outra verificação no Scanner de acessibilidade. Você verá que o app não tem mais sugestões relacionadas ao contraste de cor.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Como adicionar rótulos ausentes" duration="0">
        <p>Como <code>-</code> e <code>+</code> <code>ImageButtons</code> não têm rótulos, um leitor de tela como o TalkBack não consegue comunicar adequadamente a semântica das visualizações para o usuário, anunciando simplesmente &#34;Botão sem rótulo&#34; quando um botão é focado.</p>
<p>Para corrigir esse problema, atribua uma <code>android:contentDescription</code> para cada botão:</p>
<pre><code language="language-xml" class="language-xml">&lt;ImageButton
   android:id=&#34;@+id/subtract_button&#34;
   ...
   android:contentDescription=&#34;@string/decrement&#34; /&gt;

&lt;ImageButton
   android:id=&#34;@+id/add_button&#34;
   ...
   android:contentDescription=&#34;@string/increment&#34; /&gt;
</code></pre>
<p>Use strings localizadas nas descrições de conteúdo. Assim, elas poderão ser adequadamente traduzidas. Para este codelab, as strings já foram definidas em <code>res/values/strings.xml</code>.</p>
<p>Agora, um leitor de tela pode anunciar o valor da <code>contentDescription</code> fornecida (adequadamente traduzida para o idioma local) quando o usuário foca nos botões.</p>
<p>Execute o <strong>Scanner de acessibilidade</strong> novamente. Não há mais sugestões relacionadas a rótulos ausentes.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Como aumentar áreas de toque" duration="0">
        <p>O <strong>Scanner de acessibilidade</strong> continua sugerindo que os botões <code>-</code> e <code>+</code> precisam ter uma área de toque maior. Nesta etapa, seguiremos essa sugestão.</p>
<p>Os dois botões no <strong>Contador</strong> são pequenos (24dp x 24dp). No geral, o tamanho adequado para a área de toque de itens focáveis precisa ser, pelo menos, de 48dp x 48dp. Se for possível criar uma área ainda maior, melhor. Ao aumentar a área de toque de 24dp x 24dp para 48dp x 48dp, ela é expandida por um fator de 4.</p>
<p>Você tem várias opções para aumentar a área de toque dos botões. Por exemplo, você pode escolher uma destas opções:</p>
<ul>
<li>Adicionar padding em volta dos ícones.</li>
<li>Adicionar um <code>minWidth</code> e/ou <code>minHeight</code> (os ícones ficarão maiores).</li>
<li>Registrar um <a href="https://developer.android.com/reference/android/view/TouchDelegate" target="_blank">TouchDelegate</a>.</li>
</ul>
<p>Adicione um pouco de padding a cada visualização:</p>
<pre><code language="language-xml" class="language-xml">&lt;ImageButton
   ...
   android:padding=&#34;@dimen/icon_padding&#34;
   ... /&gt;

&lt;ImageButton
   ...
   android:padding=&#34;@dimen/icon_padding&#34;
  ... /&gt;
</code></pre>
<p>O valor de <code>@dimen/icon_padding</code> está definido como 12dp (veja <code>res/dimens.xml</code>). Quando o padding é aplicado, a área de toque do controle se torna 48dp x 48dp (24dp + 12dp em cada direção).</p>
<p>Execute o app novamente para confirmar os novos limites de layout. Agora, a área de toque dos botões é maior.</p>
<p>Execute o <strong>Scanner de acessibilidade</strong> novamente. Desta vez, a análise será concluída sem sugestões.</p>
<h2 is-upgraded>Como desativar o Scanner de acessibilidade</h2>
<p>Navegue para <strong>Configurações</strong> &gt; <strong>Acessibilidade</strong> e defina o <strong>Scanner de acessibilidade</strong> como <strong>Desativado</strong>.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Espresso" duration="20">
        <p>O <strong>Espresso</strong> é um framework de teste de interface do usuário para aplicativos Android, permitindo que os desenvolvedores criem testes automatizados para interagir com os elementos da interface do usuário do aplicativo. É integrado com o Android Studio e pode ser executado em dispositivo físico ou emulado.</p>
<p>Para testar acessibilidade com o Espresso, é possível usar a API <strong>AccessibilityChecks</strong> do <strong>Framework de Testes de Acessibilidade</strong> (<strong>ATF</strong>, na sigla em inglês).</p>
<p>Algumas das checagens realizadas pelo <strong>ATF</strong> incluem:</p>
<ul>
<li>Verificar se todos os elementos da interface do usuário têm rótulos de conteúdo e descrições de texto adequados.</li>
<li>Verificar se a ordem de foco dos elementos da interface do usuário é lógica e previsível.</li>
<li>Verificar se a taxa de contraste dos elementos da interface do usuário são suficientes.</li>
<li>Verificar se as ações do usuário na interface do usuário podem ser realizadas com gestos de toque ou com um teclado.</li>
<li>Verificar se a interface do usuário é compatível com os recursos de acessibilidade do Android, como o TalkBack e o modo de alto contraste.</li>
</ul>
<h2 is-upgraded>Preparação</h2>
<p>No Android Studio, abra o projeto do aplicativo Contador, da pasta especificada para o Espresso no 2º passo deste treinamento.</p>
<h3 is-upgraded>Configure o projeto para habilitar o AccessibilityChecks</h3>
<p>Você precisará de uma nova dependência para o pacote <strong>androidTestImplementation</strong>. Confira se a linha seguinte já foi adicionada para você no arquivo <strong>app/build.gradle</strong>.</p>
<ol type="1">
<li>Edite o arquivo <strong>build.gradle</strong> da raíz, adicionando a seguinte linha na lista de dependencias.  <aside class="special"><p><strong>Onde encontro isso?</strong> Ao abrir o projeto no Android Studio, na visualização Android (painel esquerdo), há uma seção Gradle Scripts. Dentro, há um arquivo chamado <em>build.gradle (Módulo: Contador.app)</em>, ou algo parecido.  </p>
</aside>
<pre><code language="language-groovy" class="language-groovy">dependencies {
    ...
    androidTestImplementation &#39;androidx.test.espresso:espresso-accessibility:3.3.0-alpha05&#39;        
    ...
}
</code></pre>
</li>
<li>Depois de fazer essas alterações, sincronize seu projeto para garantir que elas entrem em vigor.<img alt="Sync Now" src="img/892685a62514c808.png"></li>
</ol>
<aside class="special"><p><strong>Dica:</strong> leia mais sobre <a href="https://developer.android.com/studio/test/test-in-android-studio" target="_blank">Testes no Android Studio</a></p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Crie uma classe de teste instrumentado para a tela principal" duration="0">
        <h2 is-upgraded>Criar a classe de teste</h2>
<ol type="1">
<li>No Android Studio, abra o painel Project e encontre esta pasta:</li>
</ol>
<ul>
<li><strong>com.example.contador (androidTest)</strong>.</li>
</ul>
<ol type="1" start="2">
<li>Clique com o botão direito na pasta <strong>contador</strong> e selecione <strong>New</strong> &gt; <strong>Java Class</strong></li>
<li>Nomeie como <code>MainActivityInstrumentedTest</code>. Assim você saberá que esta classe de teste instrumentado se refere à <code>MainActivity</code>.</li>
</ol>
<h2 is-upgraded>Configurar a classe de teste</h2>
<p>Com a classe <code>MainActivityInstrumentedTest</code> gerada e aberta, crie seu primeiro teste. Para o propósito deste codelab, será escrito apenas um único teste, que verifica se o código para incrementar a contagem funciona corretamente (por questões de brevidade, o teste para decrementar a contagem foi omitido). Sua classe deverá ficar assim:</p>
<pre><code language="language-java" class="language-java">public class MainActivityInstrumentedTest {
    @Rule
    public ActivityScenarioRule&lt;MainActivity&gt; mActivityTestRule = new ActivityScenarioRule&lt;&gt;(MainActivity.class);

    @Test
    public void testIncrement(){
        Espresso.onView(withId(R.id.add_button))
            .perform(ViewActions.click());
        Espresso.onView(withId(R.id.countTV))
            .check(matches(withText(&#34;1&#34;)));
    }
}
</code></pre>
<h2 is-upgraded>Execute o teste</h2>
<p>Primeiro, verifique se o seu computador está conectado a um dispositivo com a depuração USB ativada.</p>
<p>Agora execute os testes clicando no botão de seta verde imediatamente à esquerda de <code>@Test public void testIncrement()</code>. Se você estiver usando um dispositivo físico conectado via USB, certifique-se de que o dispositivo esteja desbloqueado e com a tela ligada. Observe que pressionar <code>Ctrl+Shift+F10</code> (Control+Shift+R em um Mac) executa os testes no arquivo atualmente aberto.</p>
<p>O teste deve ser executado até o final e deve passar, confirmando que o incremento da contagem funciona como esperado.</p>
<p>Na próxima seção, você irá modificar o teste para verificar também a acessibilidade.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Habilite as checagens de acessibilidade com o Espresso" duration="5">
        <p>Com o Espresso, você pode habilitar verificações de acessibilidade chamando <strong>AccessibilityChecks.enable()</strong> de um método de configuração. Adicionar essa única linha de código permite que você teste sua interface do usuário para acessibilidade, tornando fácil integrar a verificação de acessibilidade em seu conjunto de testes.</p>
<p>Para configurar a classe <code>MainActivityInstrumentedTest</code> para checagens de acessibilidade, adicione o seguinte método de configuração antes do seu teste.</p>
<pre><code language="language-java" class="language-java">    @BeforeClass
    public static void beforeClass()
    {
        AccessibilityChecks.enable();
    }

</code></pre>
<p>Agora execute o teste novamente. Desta vez, você perceberá que o teste falha. No painel <strong>Run</strong>, clique duas vezes em <strong>testIncrement</strong> para ver os resultados. Você notará a mensagem de erro.</p>
<h2 is-upgraded>Entendendo a falha do teste</h2>
<p>O teste falhou porque o ATF encontrou duas oportunidades para melhorar a acessibilidade do aplicativo:</p>
<ol type="1">
<li>O ImageButton de adição (&#34;+&#34;) contém uma imagem, mas não tem um rótulo. Ele precisa de um rótulo para que um usuário de leitor de tela possa entender o propósito do botão.</li>
<li>O ImageButton também precisa de um alvo de toque maior para que os usuários com destreza manual limitada possam interagir com o botão com mais facilidade.</li>
</ol>
<h2 is-upgraded>Melhorando sua interface do usuário</h2>
<p>Nesta etapa, você fará alterações no arquivo <strong>res/layout/activity_main.xml</strong> para atender às sugestões do ATF que estão causando falhas nos seus testes (lembre-se de que o ATF encontrou duas oportunidades para melhorar a acessibilidade, incluindo um rótulo e o aumento do tamanho do alvo de toque):</p>
<p>Primeiro, você irá adicionar um rótulo ao botão de adicionar.</p>
<p>Abra o arquivo <strong>res/layout/activity_main.xml</strong> e procure o código do primeiro ImageButton (você notará um aviso do lint sobre a falta de <strong>contentDescription</strong>):</p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton 
        android:id=&#34;@+id/subtract_button&#34;
        ...
        android:contentDescription=&#34;@string/decrement&#34; /&gt;

    &lt;ImageButton
        android:id=&#34;@+id/add_button&#34;
        ...
        android:contentDescription=&#34;@string/increment&#34; /&gt;
</code></pre>
<p>Use strings localizadas nas descrições de conteúdo. Assim, elas poderão ser adequadamente traduzidas. Para este codelab, as strings já foram definidas em res/values/strings.xml.</p>
<p>Execute o teste novamente e você não verá mais uma falha relacionada ao rótulo do botão.</p>
<p>Agora você irá abordar a outra recomendação do ATF, que se refere ao tamanho do alvo de toque do botão. O tamanho de toque para o botão é de 24x24dp, e a mensagem de falha do teste indica que o tamanho de toque mínimo recomendado é de 48x48dp.</p>
<p>Você tem várias opções para aumentar a área sensível ao toque dos botões. Por exemplo, você pode fazer o seguinte:</p>
<p>Em <strong>res/layout/activity_main.xml</strong>, podemos ver as seguintes definições para os dois botões:</p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton
        android:id=&#34;@+id/add_button&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        ... /&gt;

    &lt;ImageButton
        android:id=&#34;@+id/subtract_button&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        ... /&gt;
</code></pre>
<p>Adicione um pouco de padding a cada visualização:</p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton
        ...
        android:padding=&#34;@dimen/icon_padding&#34;
        ... /&gt;

    &lt;ImageButton
        ...
        android:padding=&#34;@dimen/icon_padding&#34;
        ... /&gt;
</code></pre>
<p>O valor de <strong>@dimen/icon_padding</strong> está definido como 12dp (veja res/dimens.xml). Quando o padding é aplicado, a área de toque do controle se torna 48dp x 48dp (24dp + 12dp em cada direção).</p>
<p>Execute o teste novamente. A falha do teste relacionada aos alvos de toque não ocorre mais, portanto o teste é aprovado.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Realize verificações a partir do elemento raiz de uma tela" duration="0">
        <p>Todas as verificações de acessibilidade que você encontrou até agora estavam associadas ao botão &#34;adicionar&#34;, que é a visualização na qual você executou uma ação de visualização. Agora você configurará seus testes para examinar outras visualizações na hierarquia, sem precisar executar ações adicionais de visualização nessas visualizações.</p>
<p>Usando o objeto <code>AccessibilityValidator</code>, você pode chamar <code>setRunChecksFromRootView(true)</code> para obter uma cobertura expandida de acessibilidade, verificando toda a hierarquia de visualização em cada ação de visualização.</p>
<p>Modifique seu método <code>enableAccessibilityChecks()</code> da seguinte forma:</p>
<pre><code language="language-java" class="language-java">    @BeforeClass
    public static void beforeClass()
    {
        AccessibilityChecks.enable()
            .setRunChecksFromRootView(true);
    }
</code></pre>
<p>Execute os testes novamente. Desta vez, o teste falhará com a seguinte mensagem de erro:</p>
<pre><code>...
There was 1 accessibility error:
AppCompatTextView{id=-1, ...}: TextView does not have required contrast of 3.000000. Actual contrast is 2.455571
at ...
</code></pre>
<p>O texto e o plano de fundo da visualização devem ter um contraste de cor maior. Ao definir <code>setRunChecksFromRootView(true)</code>, você encontrou mais oportunidades para melhorar a acessibilidade do seu aplicativo.</p>
<p>Melhore o contraste de cor para o TextView do contador, alterando a cor do texto de @color/grey para @color/darkGrey.</p>
<pre><code language="language-xml" class="language-xml">    &lt;TextView
        ...
        android:textColor=&#34;@color/darkGrey&#34;
        ... /&gt;
</code></pre>
<p>Agora execute o teste novamente. Com o cinza mais escuro, o texto do contador tem mais contraste de cor com o fundo, então o <strong>ATF</strong> não deve fazer nenhuma sugestão de acessibilidade. O teste deve executar com sucesso até o final.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Kit de testes automatizados de acessibilidade (AATK) para aplicativos Android" duration="20">
        <p>Os aplicativos <strong>mobile</strong> podem ajudar as pessoas a realizar tarefas diárias. No entanto, pessoas com deficiência podem enfrentar várias barreiras ao usar os recursos desses dispositivos se eles não fornecerem acessibilidade adequada.</p>
<p>Os desenvolvedores de software desempenham um papel crucial na promoção de melhorias de acessibilidade digital, e os testes automatizados podem ajudá-los.</p>
<p>O <strong>Kit de Testes de Acessibilidade Automatizados para Aplicativos Android (AATK)</strong> consiste em uma coleção de testes de acessibilidade automatizados projetados para serem executados com o <strong>Robolectric</strong>. Isso permite que sejam executados como testes locais, sem a necessidade de um dispositivo físico ou emulado.</p>
<p>Este kit foi desenvolvido com foco nos problemas de acessibilidade mais comuns e nos widgets mais usados, onde muitos problemas de acessibilidade tendem a ocorrer.</p>
<h2 is-upgraded>Preparação</h2>
<p>No Android Studio, abra o projeto do aplicativo Contador, da pasta especificada para o AATK no 2º passo deste treinamento.</p>
<h3 is-upgraded>Configure o projeto para habilitar o AATK</h3>
<p>Siga os seguintes passos para preparar o projeto para adicionar testes de acessibilidade automatizados:</p>
<ol type="1">
<li>Edite o arquivo <strong>build.gradle</strong> da raíz, adicionando <strong>maven { url ‘https://jitpack.io&#39; }</strong> na lista de repositories.  <aside class="special"><p><strong>Onde encontro isso?</strong> Ao abrir o projeto no Android Studio, na visualização do Android (painel esquerdo), há uma seção <em>Gradle Scripts</em>. Dentro, há um arquivo chamado <em>settings.gradle (Project: Settings)</em>.  </p>
</aside>
<pre><code language="language-groovy" class="language-groovy">dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url &#39;https://jitpack.io&#39; }
    }
}
</code></pre>
</li>
<li>Configure seu arquivo <strong>build.gradle</strong> no nível do aplicativo para habilitar a execução de testes com o Robolectric e o AATK, atualizando os <strong>testOptions</strong> e adicionando as dependências necessárias.  <aside class="special"><p><strong>Onde encontro isso?</strong> Ao abrir o projeto no Android Studio, na visualização Android (painel esquerdo), há uma seção Gradle Scripts. Dentro, há um arquivo chamado <em>build.gradle (Módulo: Contador.app)</em>, ou algo parecido.  </p>
</aside>
Primeiro, adicione a diretiva <strong>testOptions</strong> com as seguintes linhas, dentro da diretiva <strong>android</strong>, assim:<pre><code language="language-groovy" class="language-groovy">android{
    ...
    testOptions {
        // Usado para testar elementos dependentes do Android na pasta de teste
        unitTests.includeAndroidResources  = true
        unitTests.returnDefaultValues = true
    }
}
</code></pre>
Em seguida, adicione estas duas dependências como <code>testImplementation</code>:<pre><code language="language-groovy" class="language-groovy">dependencies {
    ...
    testImplementation &#39;org.robolectric:robolectric:4.9&#39;
    testImplementation &#39;com.github.AALT-Framework:android-accessibility-test-kit:v1.0.0-alpha&#39;
    ...
}
</code></pre>
</li>
</ol>
<aside class="special"><p><strong>Dica:</strong> leia mais sobre <a href="https://developer.android.com/studio/test/test-in-android-studio" target="_blank">Testes no Android Studio</a></p>
</aside>
<ol type="1" start="3">
<li>Depois de fazer essas alterações, sincronize seu projeto para garantir que elas entrem em vigor.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Crie uma classe de teste local para a tela principal" duration="0">
        <h2 is-upgraded>Criar a classe de teste</h2>
<ol type="1">
<li>No Android Studio, abra o painel Project e encontre esta pasta:</li>
</ol>
<ul>
<li><strong>com.example.contador (test)</strong>.</li>
</ul>
<ol type="1" start="2">
<li>Clique com o botão direito na pasta <strong>contador</strong> e selecione <strong>New</strong> &gt; <strong>Java Class</strong></li>
<li>Nomeie como <code>MainActivityTest</code>. Assim você saberá que esta classe de teste se refere à <code>MainActivity</code>.</li>
</ol>
<h2 is-upgraded>Configurar a classe de teste</h2>
<p>Com a classe <code>MainActivityTest</code> gerada e aberta, comece a configurá-la para executar os testes AATK.</p>
<p>Sua classe deverá ficar assim:</p>
<pre><code language="language-java" class="language-java">@RunWith(RobolectricTestRunner.class)
public class MainActivityTest {
    private View rootView;
    private AccessibilityTestRunner runner;

    @Rule
    public ErrorCollector collector = new ErrorCollector();

    @Before
    public void setUp() {
        MainActivity activity = Robolectric.buildActivity(MainActivity.class).create().get();

        // Obtenha a view raiz da hierarquia de exibição
        rootView = activity.getWindow().getDecorView().getRootView();
        runner = new AccessibilityTestRunner(collector);
    }
}
</code></pre>
<p>O que foi feito:</p>
<ol type="1">
<li>Adicionado o escopo da classe para executar com <code>RoboletricTestRunner</code>.</li>
<li>Declarado um atributo privado para manter o <strong>rootView</strong> e o <code>AccessibilityTestRunner</code>.</li>
<li>Declarado uma propriedade pública para o <code>ErrorCollector</code>.</li>
<li>Adicionado um método <strong>setUp</strong> da seguinte para habilitar que o kit seja executado em qualquer novo texte criado.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Escreva seu primeiro teste com o AATK" duration="5">
        <p>Adicione um método de teste para cada teste de acessibilidade que deseja executar. Começaremos com a verificação da taxa de contraste de cores.</p>
<h2 is-upgraded>Crie um teste para verificar a taxa de contraste de cores</h2>
<p>Uma taxa de contraste adequada ajuda os usuários a identificar melhor o conteúdo do aplicativo. Uma relação de contraste de pelo menos 4,5:1 deve ser usada.</p>
<p>Você pode utilizar o teste de taxa de contraste do <strong>AATK</strong> (<code>TestAdequateContrastRatio</code>) da seguinte forma:</p>
<ol type="1">
<li>Adicione um método de teste. Procure seguir boas convenções para nomenclatura de testes. Por exemplo: <strong>deve_UsarTaxaDeContrasteAdequada</strong></li>
<li>Chame o método <strong>runAccessibilityTest</strong> do executor do kit, passando como parâmetro a view raíz e uma nova instância do teste desejado.<pre><code language="language-java" class="language-java">    @Test
    public void deve_UsarTaxaDeContrasteAdequada(){
        runner.runAccessibilityTest(rootView, new TestAdequateContrastRatio());
    }
</code></pre>
</li>
<li>Execute seu teste. Clique com o botão direito do mouse sobre o nome do método e selecione <strong>Run MainActivityTest.deve_UsarTaxaDeContrasteAdequada</strong></li>
<li>No painel <strong>Run</strong>, clique duas vezes em <strong>deve_UsarTaxaDeContrasteAdequada</strong> para ver os resultados. Você notará a mensagem de erro, a identificação <code>View</code>, a taxa esperada e a taxa atual.  <aside class="special"><p><strong>O que isso significa?</strong> No **Contador**, é fácil melhorar o contraste de cores. O TextView exibindo a contagem usa um plano de fundo cinza claro e uma cor de texto cinza. Você pode remover o plano de fundo, escolher um plano de fundo mais claro ou escolher uma cor de texto mais escura. Neste codelab, você escolherá uma cor de texto mais escura.  </p>
</aside>
</li>
<li>Abra o arquivo <strong>res/layout/activity_main.xml</strong>, encontre o <strong>TextView</strong> e altere <strong>android:textColor=&#34;@color/grey&#34;</strong> para <strong>android:textColor=&#34;@color/darkGrey&#34;</strong>.  <aside class="special"><p>  Os nomes dessas cores são uma predefinições desse projeto de exemplo. Para ver todas as cores pré-definidas, verifique o arquivo <strong>res/values/colors.xml</strong>.  </p>
</aside>
</li>
<li>Volte ao item <strong>3</strong> para refazer o teste e ver se ele passou.</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Escreva novos testes" duration="5">
        <p>Agora que já criou seu primeiro teste, você pode adicionar outros. A seguir, iremos sugerir mais dois exemplos. Consulte a <a href="https://github.com/AALT-Framework/android-accessibility-test-kit" target="_blank">documentação do AATK</a> para consultar todos os testes disponíveis.</p>
<h2 is-upgraded>Crie um teste para verificar conteúdos não textuais sem descrição alternativa</h2>
<p>Todo conteúdo não textual deve ter uma descrição de texto alternativa. Isso permite que um leitor de tela possa identificar corretamente o conteúdo.</p>
<p>Para esse teste, você irá utilizar o teste de texto alternativo do <strong>AATK</strong> (<code>TestMustHaveAlternativeText</code>), assim como fez para o teste de contraste.</p>
<ol type="1">
<li>Adicione um método de teste. Por exemplo: <strong>deve_ConterAlternativaTextual</strong></li>
<li>Chame o método <strong>runAccessibilityTest</strong> do executor do kit, passando como parâmetro a view raíz e uma nova instância do teste desejado.<pre><code language="language-java" class="language-java">    @Test
    public void deve_ConterAlternativaTextual(){
        runner.runAccessibilityTest(rootView, new TestMustHaveAlternativeText());
    }
</code></pre>
</li>
<li>Execute seu teste. Verifique os resultados. Realize as correções. Reexecute o teste.  <aside class="special"><p><strong>Dica:</strong> No **Contador**, os controles - e + não tem rótulos. Para corrigir esse problema, atribua uma <strong>android:contentDescription</strong> para cada botão. </p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton 
        android:id=&#34;@+id/subtract_button&#34;
        ...
        android:contentDescription=&#34;@string/decrement&#34; /&gt;

    &lt;ImageButton
        android:id=&#34;@+id/add_button&#34;
        ...
        android:contentDescription=&#34;@string/increment&#34; /&gt;
</code></pre>
<p>Use strings localizadas nas descrições de conteúdo. Assim, elas poderão ser adequadamente traduzidas. Para este codelab, as strings já foram definidas em <em>res/values/strings.xml</em>.</p>
</aside>
</li>
</ol>
<h2 is-upgraded>Crie um teste para verificar o tamanho dos alvos de toque</h2>
<p>Todos os elementos de interação devem ter no mínimo 48x48dp.</p>
<p>Para esse teste, você irá utilizar o teste de texto alternativo do <strong>AATK</strong> (<code>TestTouchTargetSize</code>), assim como fez para os testes anteriores.</p>
<ol type="1">
<li>Adicione um método de teste. Por exemplo: <strong>deve_AlvoDeToquePossuirTamanhoMinimo</strong></li>
<li>Chame o método <strong>runAccessibilityTest</strong> do executor do kit, passando como parâmetro a view raíz e uma nova instância do teste desejado.<pre><code language="language-java" class="language-java">    @Test
    public void deve_AlvoDeToquePossuirTamanhoMinimo(){
        runner.runAccessibilityTest(rootView, new TestTouchTargetSize());
    }
</code></pre>
</li>
<li>Execute seu teste. Verifique os resultados. Realize as correções. Reexecute o teste.  <aside class="special"><p><strong>Dica:</strong> Em <strong>res/layout/activity_main.xml</strong>, podemos ver as seguintes definições para os dois botões: </p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton
        android:id=&#34;@+id/add_button&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        ... /&gt;

    &lt;ImageButton
        android:id=&#34;@+id/subtract_button&#34;
        android:layout_width=&#34;wrap_content&#34;
        android:layout_height=&#34;wrap_content&#34;
        ... /&gt;
</code></pre>
<p>Adicione um pouco de padding a cada visualização:</p>
<pre><code language="language-xml" class="language-xml">    &lt;ImageButton
        ...
        android:padding=&#34;@dimen/icon_padding&#34;
        ... /&gt;

    &lt;ImageButton
        ...
        android:padding=&#34;@dimen/icon_padding&#34;
        ... /&gt;
</code></pre>
<p>O valor de <em>@dimen/icon_padding</em> está definido como 12dp (veja <em>res/dimens.xml</em>). Quando o padding é aplicado, a área de toque do controle se torna 48dp x 48dp (24dp + 12dp em cada direção).</p>
</aside>
</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusão" duration="0">
        <p>Obrigado por sua participação!</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
